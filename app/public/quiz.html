<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Friend finder</title>
  <link rel="icon" href="assets/img/favicon.ico" type="image/x-icon">
 <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:100&effect=neon">
 <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400|Poiret+One" rel="stylesheet">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="assets/css/style.css">
  <script src="https://code.jquery.com/jquery.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
</head>
<body>
	<div class="container">
	<h1>SWEET FRIEND QUIZ</h1>
	<form id="quiz-form" required>
		<div class="form-group clearfix">
			<h2>personal information</h2>
	    <!-- <label for="email">Full Name</label> -->
	    <input type="text" class="form-control user-info" id="user-name" placeholder="first & last initial" required>
	    <!-- <label for="email">Selfie</label> -->
	    <input type="text" class="form-control" id="user-image" placeholder="image url" required>
	  </div>
		<div class="form-group">
			<h2>question 1</h2>
			<div class="btn-toolbar" data-toggle="buttons">
			  <label class="btn btn-primary">
			    <input type="radio" name="score-0" id="option1" autocomplete="off" value="1"> OPT 1
			  </label>
			  <label class="btn btn-primary">
			    <input type="radio" name="score-0" id="option2" autocomplete="off" value="2"> OPT 2
			  </label>
			  <label class="btn btn-primary">
			    <input type="radio" name="score-0" id="option3" autocomplete="off" value="3"> OPT 3
			  </label>
			  <label class="btn btn-primary">
			    <input type="radio" name="score-0" id="option4" autocomplete="off" value="4"> OPT 4
			  </label>
			  <label class="btn btn-primary">
			    <input type="radio" name="score-0" id="option5" autocomplete="off" value="5"> OPT 5
			  </label>
			</div>
		</div>
		<div class="form-group">
			<h2>question 2</h2>
			<div class="btn-toolbar" data-toggle="buttons">
			  <label class="btn btn-primary">
			    <input type="radio" name="score-1" id="option6" autocomplete="off" value="1"> OPT 1
			  </label>
			  <label class="btn btn-primary">
			    <input type="radio" name="score-1" id="option7" autocomplete="off" value="2"> OPT 2
			  </label>
			  <label class="btn btn-primary">
			    <input type="radio" name="score-1" id="option8" autocomplete="off" value="3"> OPT 3
			  </label>
			  <label class="btn btn-primary">
		    	<input type="radio" name="score-1" id="option9" autocomplete="off" value="4"> OPT 4
		  	</label>
		  	<label class="btn btn-primary">
			    <input type="radio" name="score-1" id="option10" autocomplete="off" value="5"> OPT 5
			  </label>
			</div>
		</div>
		<div class="form-group">
			<h2>question 3</h2>
			<div class="btn-toolbar" data-toggle="buttons">
			  <label class="btn btn-primary">
			    <input type="radio" name="score-2" id="option11" autocomplete="off" value="1"> OPT 1
			  </label>
			  <label class="btn btn-primary">
			    <input type="radio" name="score-2" id="option12" autocomplete="off" value="2"> OPT 2
			  </label>
			  <label class="btn btn-primary">
			    <input type="radio" name="score-2" id="option13" autocomplete="off" value="3"> OPT 3
			  </label>
			  <label class="btn btn-primary">
		    	<input type="radio" name="score-2" id="option14" autocomplete="off" value="4"> OPT 4
		  	</label>
		  	<label class="btn btn-primary">
			    <input type="radio" name="score-2" id="option15" autocomplete="off" value="5"> OPT 5
			  </label>
			</div>
		</div>
		<div class="form-group">
			<h2>question 4</h2>
			<div class="btn-toolbar" data-toggle="buttons">
			  <label class="btn btn-primary">
			    <input type="radio" name="score-3" id="option16" autocomplete="off" value="1"> OPT 1
			  </label>
			  <label class="btn btn-primary">
			    <input type="radio" name="score-3" id="option17" autocomplete="off" value="2"> OPT 2
			  </label>
			  <label class="btn btn-primary">
			    <input type="radio" name="score-3" id="option18" autocomplete="off" value="3"> OPT 3
			  </label>
			  <label class="btn btn-primary">
		    	<input type="radio" name="score-3" id="option19" autocomplete="off" value="4"> OPT 4
		  	</label>
		  	<label class="btn btn-primary">
			    <input type="radio" name="score-3" id="option20" autocomplete="off" value="5"> OPT 5
			  </label>
			</div>
		</div>
		<div class="form-group">
			<h2>question 5</h2>
			<div class="btn-toolbar" data-toggle="buttons">
			  <label class="btn btn-primary">
			    <input type="radio" name="score-4" id="option21" autocomplete="off" value="1"> OPT 1
			  </label>
			  <label class="btn btn-primary">
			    <input type="radio" name="score-4" id="option22" autocomplete="off" value="2"> OPT 2
			  </label>
			  <label class="btn btn-primary">
			    <input type="radio" name="score-4" id="option23" autocomplete="off" value="3"> OPT 3
			  </label>
			  <label class="btn btn-primary">
		    	<input type="radio" name="score-4" id="option24" autocomplete="off" value="4"> OPT 4
		  	</label>
		  	<label class="btn btn-primary">
			    <input type="radio" name="score-4" id="option25" autocomplete="off" value="5"> OPT 5
			  </label>
			</div>
		</div>
		<div class="form-group">
			<h2>question 6</h2>
			<div class="btn-toolbar" data-toggle="buttons">
			  <label class="btn btn-primary">
			    <input type="radio" name="score-5" id="option26" autocomplete="off" value="1"> OPT 1
			  </label>
			  <label class="btn btn-primary">
			    <input type="radio" name="score-5" id="option27" autocomplete="off" value="2"> OPT 2
			  </label>
			  <label class="btn btn-primary">
			    <input type="radio" name="score-5" id="option28" autocomplete="off" value="3"> OPT 3
			  </label>
			  <label class="btn btn-primary">
		    	<input type="radio" name="score-5" id="option29" autocomplete="off" value="4"> OPT 4
		  	</label>
		  	<label class="btn btn-primary">
			    <input type="radio" name="score-5" id="option30" autocomplete="off" value="5"> OPT 5
			  </label>
			</div>
		</div>
		<div class="form-group">
			<h2>question 7</h2>
			<div class="btn-toolbar" data-toggle="buttons">
			  <label class="btn btn-primary">
			    <input type="radio" name="score-6" id="option31" autocomplete="off" value="1"> OPT 1
			  </label>
			  <label class="btn btn-primary">
			    <input type="radio" name="score-6" id="option32" autocomplete="off" value="2"> OPT 2
			  </label>
			  <label class="btn btn-primary">
			    <input type="radio" name="score-6" id="option33" autocomplete="off" value="3"> OPT 3
			  </label>
			  <label class="btn btn-primary">
		    	<input type="radio" name="score-6" id="option34" autocomplete="off" value="4"> OPT 4
		  	</label>
		  	<label class="btn btn-primary">
			    <input type="radio" name="score-6" id="option35" autocomplete="off" value="5"> OPT 5
			  </label>
			</div>
		</div>
		<div class="form-group">
			<h2>question 8</h2>
			<div class="btn-toolbar" data-toggle="buttons">
			  <label class="btn btn-primary">
			    <input type="radio" name="score-7" id="option36" autocomplete="off" value="1"> OPT 1
			  </label>
			  <label class="btn btn-primary">
			    <input type="radio" name="score-7" id="option37" autocomplete="off" value="2"> OPT 2
			  </label>
			  <label class="btn btn-primary">
			    <input type="radio" name="score-7" id="option38" autocomplete="off" value="3"> OPT 3
			  </label>
			  <label class="btn btn-primary">
		    	<input type="radio" name="score-7" id="option39" autocomplete="off" value="4"> OPT 4
		  	</label>
		  	<label class="btn btn-primary">
			    <input type="radio" name="score-7" id="option40" autocomplete="off" value="5"> OPT 5
			  </label>
			</div>
		</div>
		<div class="form-group">
			<h2>question 9</h2>
			<div class="btn-toolbar" data-toggle="buttons">
			  <label class="btn btn-primary">
			    <input type="radio" name="score-8" id="option41" autocomplete="off" value="1"> OPT 1
			  </label>
			  <label class="btn btn-primary">
			    <input type="radio" name="score-8" id="option42" autocomplete="off" value="2"> OPT 2
			  </label>
			  <label class="btn btn-primary">
			    <input type="radio" name="score-8" id="option43" autocomplete="off" value="3"> OPT 3
			  </label>
			  <label class="btn btn-primary">
		    	<input type="radio" name="score-8" id="option44" autocomplete="off" value="4"> OPT 4
		  	</label>
		  	<label class="btn btn-primary">
			    <input type="radio" name="score-8" id="option45" autocomplete="off" value="5"> OPT 5
			  </label>
			</div>
		</div>
		<div class="form-group">
			<h2>question 10</h2>
			<div class="btn-toolbar" data-toggle="buttons">
			  <label class="btn btn-primary">
			    <input type="radio" name="score-9" id="option46" autocomplete="off" value="1"> OPT 1
			  </label>
			  <label class="btn btn-primary">
			    <input type="radio" name="score-9" id="option47" autocomplete="off" value="2"> OPT 2
			  </label>
			  <label class="btn btn-primary">
			    <input type="radio" name="score-9" id="option48" autocomplete="off" value="3"> OPT 3
			  </label>
			  <label class="btn btn-primary">
		    	<input type="radio" name="score-9" id="option49" autocomplete="off" value="4"> OPT 4
		  	</label>
		  	<label class="btn btn-primary">
			    <input type="radio" name="score-9" id="option50" autocomplete="off" value="5"> OPT 5
			  </label>
			</div>
		</div>
		<button id="submit" type="button" class="btn btn-default" data-loading-text="Loading..." autocomplete="off" >Submit</button>
	</form>
<!-- data-toggle="modal" data-target="#myModal" -->
	<div class="modal fade" id="result-modal" role="dialog">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h1>It's a match!</h1>
        </div>
        <div class="modal-body">
        </div>
        <!-- <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div> -->
      </div>
    </div>
  </div>
	</div>
	<script type="text/javascript">

	class Friend {
		constructor(score){
			this.name = $("#user-name").val().trim();
			this.image = $("#user-image").val().trim();
			this.score = [];
		}
	}

	$("#submit").on("click", function(e) {
		e.preventDefault();
		//form validation
		
		var newFriend = new Friend();
		for(var i = 0; i < 10;i++){
			var results = $(`input:radio[name='score-${i}']:checked`).val();
			//console.log(results)
			newFriend.score.push(results);
		}
		
		//console.log(newFriend.score);
		//console.log(newFriend);

		if(ValidURL(newFriend.image) && newFriend.name.length > 0 && newFriend.score.length === 10 && !newFriend.score.includes(NaN) && !newFriend.score.includes(null)){
     	console.log("we can do our post now");
     	var btn = $(this).button('loading');
     	getMatch(newFriend, btn);
    }
    else {
    	if(!ValidURL(newFriend.image)){
        console.log("Please enter valid URL.");
     	}
     	else if(newFriend.name.length < 1){
     		console.log("please add your name.")
     	}
     	else if(newFriend.score.includes(NaN) || newFriend.score.includes(null)){
        console.log("Please answer all the questions.");
     	}
    }
	});
   
 	function getMatch(newFriend, btn){
 		$.post("/api/quiz", newFriend,function(data) {
	    	btn.button('reset');
	    
	      console.log("result: ", data);
	      renderMatch(data)
	    $("form").trigger("reset");
	  });
 	}

	function renderMatch(data){
		$(".modal-body").empty();

		var modalContent = `
														<div class="row">
															  <div class="col-sm-6 col-md-4">
																  <div class="row">
																  	<div class="col-sm-12 col-md-10">
																  		   <div class="thumbnail">
																      <img class="candy-img" src="${data[0].image}" alt="your selfie">
																      <div class="caption">
																        <h3>${data[0].name}</h3>
																      </div>
																    </div>
																  	</div>
																		<div class="col-sm-12 col-md-2"><h4>+</h4></div>
																  </div>
															  </div>
															  <div class="col-sm-6 col-md-4">
																	<div class="row">
																  	<div class="col-sm-12 col-md-10">
																  		<div class="thumbnail">
															      <img src="${data[1].image}" alt="sweet treat">
															      <div class="caption">
															        <h3>${data[1].name}</h3>
															      </div>
															    </div>
																  	</div>
																		<div class="col-sm-12 col-md-2"><h4>+</h4></div>
																  </div>
															  </div>
															  <div class="col-sm-6 col-md-4">
															  	<div class="row">
																  	<div class="col-sm-12 col-md-10">
																  		<div class="thumbnail">
															      <img class="candy-img" src="${data[2].image}" alt="sweet friend">
															      <div class="caption">
															        <h3>${data[2].name}</h3>
															      </div>
															    </div>
																  	</div>
																		<div class="col-sm-12 col-md-2"></div>
																  </div>
															  </div>
															</div>
															<div class="row">
																<div col-md-12><h2>Sweetest Friends</h2></div>
															</div>`;

	  $(".modal-body").append(modalContent);
		$("#result-modal").modal('show');
	}

	function ValidURL(str) {
	  var regex = /(http|https):\/\/(\w+:{0,1}\w*)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%!\-\/]))?/;
	  if(!regex .test(str)) {
	    //alert("Please enter valid URL.");
	    return false;
	  } else {
	    return true;
	  }
	}
</script>
</body>
</html>